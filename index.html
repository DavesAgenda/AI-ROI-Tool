<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Automation ROI Calculator</title>
  <link rel="icon" type="image/png" href="assets/va-logo-circle.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    /* ===== Valid Agenda Brand Settings ===== */
    :root {
      --va-primary: #134061;
      --va-secondary: #0f2b45;
      --va-accent: #f48847;
      --va-accent-soft: #f9a66c;
      --va-bg: #0f1f33;
      --va-text: #0d2236;
      --va-border: #d9e1ea;
      --va-panel: #ffffff;
      --va-muted: #526880;
      --va-cream: #f5f7fa;
      --va-line: var(--va-border);
      --va-danger: #c94b4b;
      --va-success: #1c9b6c;
      --va-shadow: 0 26px 90px rgba(19, 64, 97, 0.18);
      --va-radius: 16px;
      --va-spacing: 16px;
      --va-font-heading: "Poppins", "Manrope", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
      --va-font-body: "Manrope", "Poppins", -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
      --va-font: var(--va-font-body);
    }

    /* Footer styling (scoped to calculator) */
    #va-roi-calculator .va-site-footer {
      margin: 36px auto 0;
      padding: 32px;
      background: #0f3555;
      border-radius: 20px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.16);
      color: #f5f9ff;
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    #va-roi-calculator .va-site-footer-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 28px 40px;
      align-items: flex-start;
    }

    #va-roi-calculator .va-site-footer-brand {
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: flex-start;
    }

    #va-roi-calculator .va-site-footer-brand img {
      width: 160px;
      height: auto;
      object-fit: contain;
      filter: drop-shadow(0 12px 28px rgba(0,0,0,0.25));
    }

    #va-roi-calculator .va-site-footer-tagline {
      margin: 0;
      color: #f9a66c;
      font-weight: 700;
      letter-spacing: 0.4px;
    }

    #va-roi-calculator .va-site-footer h4 {
      margin: 0 0 8px;
      font-size: 1.05rem;
      letter-spacing: 0.4px;
      color: #f48847;
    }

    #va-roi-calculator .va-site-footer p {
      margin: 4px 0;
      color: #eef4fb;
      line-height: 1.6;
    }

    #va-roi-calculator .va-site-footer a {
      color: #f9a66c;
      text-decoration: none;
      font-weight: 600;
    }

    #va-roi-calculator .va-site-footer a:hover {
      color: #f7c08f;
      text-decoration: underline;
    }

    #va-roi-calculator .va-site-footer-contact {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    #va-roi-calculator .va-site-footer-social {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-top: 8px;
    }

    #va-roi-calculator .va-site-footer-social a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #f5f9ff;
      color: #0f3555;
      box-shadow: 0 6px 16px rgba(0,0,0,0.15);
    }

    #va-roi-calculator .va-site-footer-bottom {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-top: 24px;
      padding-top: 16px;
      border-top: 1px solid rgba(245, 249, 255, 0.18);
      color: #d9e4f2;
      flex-wrap: wrap;
      font-size: 0.95rem;
    }

    #va-roi-calculator .va-site-footer-links {
      display: flex;
      gap: 14px;
      align-items: center;
      flex-wrap: wrap;
    }

    @media (max-width: 640px) {
      #va-roi-calculator .va-site-footer {
        padding: 26px;
      }
      #va-roi-calculator .va-site-footer-bottom {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    /* Scoped styling tuned to Valid Agenda brand */
    #va-roi-calculator {
      background: linear-gradient(135deg, rgba(19, 64, 97, 0.92), rgba(19, 64, 97, 0.82) 18%, rgba(15, 31, 51, 0.88)),
        radial-gradient(circle at 20% 20%, rgba(244, 136, 71, 0.15), transparent 40%),
        radial-gradient(circle at 80% 0%, rgba(255, 255, 255, 0.08), transparent 26%);
      color: var(--va-text);
      padding: 24px 0;
      font-family: var(--va-font-body);
    }

    #va-roi-calculator .va-roi {
      font-family: var(--va-font-body);
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.05), rgba(244, 136, 71, 0.08)), var(--va-bg);
      color: var(--va-text);
      min-height: 100vh;
      margin: 0;
      padding: 48px 18px 80px;
      box-sizing: border-box;
      scroll-behavior: smooth;
      font-size: 16px;
      line-height: 1.6;
    }

    #va-roi-calculator .va-shell {
      max-width: 1180px;
      margin: 0 auto 90px;
      background: var(--va-panel);
      border: 1px solid rgba(217, 225, 234, 0.9);
      box-shadow: var(--va-shadow);
      border-radius: 24px;
      padding: 36px;
      position: relative;
      overflow: hidden;
      isolation: isolate;
      backdrop-filter: blur(4px);
    }

    #va-roi-calculator .va-shell::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        linear-gradient(120deg, rgba(19, 64, 97, 0.12), transparent 42%, rgba(244, 136, 71, 0.09) 100%),
        linear-gradient(-8deg, rgba(19, 64, 97, 0.08), transparent 50%);
      opacity: 0.7;
      z-index: 0;
      pointer-events: none;
    }

    #va-roi-calculator .va-shell > * {
      position: relative;
      z-index: 1;
    }

    #va-roi-calculator .va-hero {
      max-width: 1180px;
      margin: 0 auto 28px;
      padding: 0 6px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    #va-roi-calculator .va-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 16px;
      flex-wrap: wrap;
      margin-bottom: 18px;
    }

    #va-roi-calculator .va-hero .va-title {
      color: #fff;
    }

    #va-roi-calculator .va-hero .va-lede {
      color: rgba(255, 255, 255, 0.82);
    }

    #va-roi-calculator .va-hero .va-tagline {
      color: rgba(255, 255, 255, 0.72);
    }

    #va-roi-calculator .va-hero .va-tag {
      color: #fff;
      border-color: rgba(244, 136, 71, 0.6);
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.18);
    }

    #va-roi-calculator .va-brand {
      display: flex;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
    }

    #va-roi-calculator .va-logo {
      width: 180px;
      height: auto;
      display: block;
      padding: 10px 14px;
      border-radius: 14px;
      background: linear-gradient(120deg, rgba(19, 64, 97, 0.08), rgba(244, 136, 71, 0.08));
      filter: drop-shadow(0 10px 24px rgba(19, 64, 97, 0.14));
      object-fit: contain;
    }

    #va-roi-calculator .va-tagline {
      margin: 0 0 4px;
      font-size: 0.95rem;
      letter-spacing: 0.4px;
      text-transform: uppercase;
      color: var(--va-muted);
      font-weight: 700;
    }

    #va-roi-calculator .va-title {
      margin: 0;
      font-size: 2.2rem;
      letter-spacing: -0.4px;
      font-family: var(--va-font-heading);
      color: var(--va-primary);
    }

    #va-roi-calculator .va-lede {
      color: var(--va-muted);
      margin: 6px 0 0;
      max-width: 720px;
      line-height: 1.5;
    }

    #va-roi-calculator .va-tag {
      padding: 8px 14px;
      background: rgba(244, 136, 71, 0.16);
      border: 1px solid rgba(244, 136, 71, 0.38);
      color: var(--va-primary);
      border-radius: 999px;
      font-size: 0.95rem;
      letter-spacing: 0.2px;
      white-space: nowrap;
      font-weight: 700;
    }

    #va-roi-calculator .va-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }

    #va-roi-calculator .va-card {
      background: var(--va-panel);
      border-radius: 20px;
      padding: 28px;
      border: 1px solid var(--va-line);
      box-shadow: 0 18px 50px rgba(19, 64, 97, 0.12);
    }

    #va-roi-calculator .va-hero-card {
      box-shadow: 0 22px 60px rgba(0, 0, 0, 0.22);
      border-color: rgba(255, 255, 255, 0.08);
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.12)), rgba(15, 31, 51, 0.8);
      color: #fff;
    }

    #va-roi-calculator .va-hero-card h3,
    #va-roi-calculator .va-hero-card h4,
    #va-roi-calculator .va-hero-card p {
      color: #fff !important;
    }

    #va-roi-calculator .va-hero-card ul {
      color: rgba(255, 255, 255, 0.86);
    }

    #va-roi-calculator .va-hero-card .va-info-card {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0.04));
      border: 1px solid rgba(255, 255, 255, 0.24);
      color: #fff;
    }

    #va-roi-calculator .va-hero-card .va-info-card h4 {
      color: #fff;
    }

    #va-roi-calculator .va-hero-card .va-info-card ul {
      color: rgba(255, 255, 255, 0.9);
    }

    #va-roi-calculator .va-hero-card .va-info-card li::marker {
      color: rgba(255, 255, 255, 0.7);
    }

    #va-roi-calculator .va-hero-card .va-proceed {
      background: linear-gradient(135deg, var(--va-accent), var(--va-accent-soft));
      color: #fff;
      border: none;
      box-shadow: 0 14px 30px rgba(244, 136, 71, 0.32);
    }

    #va-roi-calculator .va-card h3 {
      margin: 0 0 12px;
      font-size: 1.3rem;
      color: var(--va-primary);
      font-weight: 800;
      letter-spacing: -0.2px;
      font-family: var(--va-font-heading);
    }

    #va-roi-calculator .va-card p {
      margin: 6px 0 12px;
      color: var(--va-muted);
      line-height: 1.5;
      font-size: 0.95rem;
    }

    #va-roi-calculator .va-field {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 18px;
    }

    #va-roi-calculator .va-field label {
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      font-size: 0.95rem;
      color: var(--va-primary);
    }

    #va-roi-calculator .va-field small {
      color: var(--va-muted);
      font-weight: 400;
    }

    #va-roi-calculator .va-lead-form {
      display: flex;
      flex-direction: column;
      gap: 14px;
      margin-top: 6px;
    }

    #va-roi-calculator .va-checkbox {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      justify-content: flex-start;
      text-align: left;
      font-size: 0.95rem;
      color: var(--va-primary);
    }

    #va-roi-calculator .va-checkbox input[type="checkbox"] {
      width: 18px;
      height: 18px;
      margin-top: 3px;
      accent-color: var(--va-accent);
      cursor: pointer;
    }

    #va-roi-calculator .va-inline-note {
      color: var(--va-muted);
      font-size: 0.9rem;
      margin-top: -4px;
    }

    #va-roi-calculator .va-lead-actions {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    #va-roi-calculator .va-form-status {
      font-size: 0.95rem;
    }

    #va-roi-calculator .va-form-status.success { color: var(--va-success); }
    #va-roi-calculator .va-form-status.error { color: var(--va-danger); }

    #va-roi-calculator .va-download-banner {
      background: linear-gradient(135deg, #134061, #0f2b45);
      color: #fff;
      border: 1px solid rgba(255, 255, 255, 0.18);
      box-shadow: 0 28px 60px rgba(19, 64, 97, 0.35);
    }

    #va-roi-calculator .va-download-banner p {
      color: #fff;
    }

    #va-roi-calculator .va-download-heading {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1.4rem;
      font-weight: 800;
    }

    #va-roi-calculator .va-download-grid {
      display: grid;
      grid-template-columns: 1.2fr 1fr;
      gap: 16px;
      align-items: end;
    }

    #va-roi-calculator .va-download-grid .va-field-role,
    #va-roi-calculator .va-download-grid .va-field-email {
      grid-column: 1 / -1;
    }

    #va-roi-calculator .va-download-note {
      color: #fff;
      font-size: 1rem;
      margin: 6px 0 10px;
    }

    #va-roi-calculator .va-download-cta {
      background: #f48847;
      border-color: #f9a66c;
      color: #fff;
    }

    #va-roi-calculator .va-next-strip {
      background: #f5f7fa;
      border: 1px dashed var(--va-line);
      box-shadow: none;
    }

    @media (max-width: 768px) {
      #va-roi-calculator .va-download-grid {
        grid-template-columns: 1fr;
      }
    }

    #va-roi-calculator .va-input,
    #va-roi-calculator .va-select {
      background: var(--va-cream);
      border: 1px solid var(--va-line);
      color: var(--va-text);
      padding: 14px 16px;
      border-radius: 10px;
      font-size: 1rem;
      outline: none;
      transition: border 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    #va-roi-calculator .va-input:focus,
    #va-roi-calculator .va-select:focus {
      border-color: var(--va-accent);
      background: var(--va-panel);
      box-shadow: 0 0 0 3px rgba(244, 136, 71, 0.22);
    }

    #va-roi-calculator .va-toggle {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    #va-roi-calculator .va-btn {
      background: var(--va-panel);
      border: 1px solid var(--va-line);
      color: var(--va-primary);
      padding: 10px 16px;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.15s ease;
      font-weight: 600;
    }

    #va-roi-calculator .va-btn:hover {
      background: rgba(19, 64, 97, 0.06);
    }

    #va-roi-calculator .va-btn.active {
      background: var(--va-accent);
      color: #fff;
      border-color: var(--va-accent);
      box-shadow: 0 10px 25px rgba(244, 136, 71, 0.25);
    }

    #va-roi-calculator .va-highlight {
      background: var(--va-cream);
      border: 1px solid var(--va-line);
      border-radius: 16px;
      padding: 18px;
      margin-top: 10px;
      box-shadow: 0 12px 30px rgba(19, 64, 97, 0.08);
    }

    #va-roi-calculator .va-highlight strong {
      font-size: 1.1rem;
    }

    #va-roi-calculator .va-matrix {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 12px;
      margin-top: 12px;
    }

    #va-roi-calculator .va-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(19, 64, 97, 0.06);
      border: 1px solid var(--va-line);
      font-size: 0.9rem;
      color: var(--va-primary);
      width: fit-content;
    }

    #va-roi-calculator .va-error {
      color: var(--va-danger);
      font-size: 0.9rem;
      margin: 6px 0 0;
    }

    #va-roi-calculator .va-success {
      color: var(--va-success);
      font-weight: 600;
    }

    #va-roi-calculator .va-progress {
      background: rgba(19, 64, 97, 0.06);
      border-radius: 12px;
      border: 1px solid rgba(217, 225, 234, 0.9);
      overflow: hidden;
      height: 12px;
      position: relative;
      margin-top: 8px;
    }

    #va-roi-calculator .va-progress span {
      display: block;
      height: 100%;
      background: linear-gradient(90deg, var(--va-accent), var(--va-accent-soft));
      width: 0%;
      transition: width 0.25s ease;
    }

    #va-roi-calculator .va-chart {
      background: var(--va-cream);
      border-radius: 12px;
      border: 1px solid var(--va-line);
      padding: 12px;
      margin-top: 8px;
    }

    #va-roi-calculator .va-chart-bar {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    #va-roi-calculator .va-bar {
      height: 10px;
      border-radius: 999px;
      background: rgba(19, 64, 97, 0.12);
      overflow: hidden;
      flex: 1;
    }

    #va-roi-calculator .va-bar span {
      display: block;
      height: 100%;
      background: var(--va-accent);
      width: 0%;
      transition: width 0.25s ease;
    }

    #va-roi-calculator .va-badge {
      padding: 4px 8px;
      border-radius: 8px;
      font-size: 0.85rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: inline-block;
    }

    .va-badge.quick { background: rgba(244, 136, 71, 0.14); color: #c05c29; border: 1px solid rgba(244, 136, 71, 0.38); }
    .va-badge.bet { background: rgba(19, 64, 97, 0.12); color: #134061; border: 1px solid rgba(19, 64, 97, 0.32); }
    .va-badge.hobby { background: rgba(15, 31, 51, 0.06); color: var(--va-muted); border: 1px solid rgba(19, 64, 97, 0.16); }
    .va-badge.trap { background: rgba(201, 75, 75, 0.14); color: #a03b3b; border: 1px solid rgba(201, 75, 75, 0.45); }

    #va-roi-calculator .va-footer {
      margin-top: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
    }

    #va-roi-calculator .va-cta {
      background: linear-gradient(135deg, var(--va-accent), var(--va-accent-soft));
      color: #fff;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
      letter-spacing: 0.2px;
      box-shadow: 0 14px 34px rgba(244, 136, 71, 0.32);
    }

    #va-roi-calculator .va-proceed {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      margin-top: 14px;
      padding: 10px 14px;
      background: var(--va-panel);
      border: 1px solid var(--va-line);
      border-radius: 12px;
      color: var(--va-primary);
      font-weight: 700;
      text-decoration: none;
      transition: all 0.2s ease;
    }

    #va-roi-calculator .va-proceed:hover {
      background: rgba(19, 64, 97, 0.06);
      border-color: var(--va-accent);
      color: var(--va-accent);
      box-shadow: 0 10px 24px rgba(19, 64, 97, 0.18);
    }

    #va-roi-calculator .va-table {
      margin-top: 14px;
      border: 1px solid var(--va-line);
      border-radius: 16px;
      overflow: hidden;
      background: #fff;
      box-shadow: 0 12px 30px rgba(15, 53, 85, 0.05);
    }

    #va-roi-calculator .va-table-head,
    #va-roi-calculator .va-table-foot {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr;
      gap: 6px;
      padding: 10px 14px;
      background: var(--va-cream);
      color: var(--va-primary);
      font-weight: 700;
      font-size: 0.95rem;
    }

    #va-roi-calculator .va-table-body {
      display: flex;
      flex-direction: column;
    }

    #va-roi-calculator .va-table-row {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr;
      gap: 6px;
      padding: 12px 14px;
      border-top: 1px solid var(--va-line);
      align-items: center;
      color: var(--va-primary);
    }

    #va-roi-calculator .va-table-row small {
      color: var(--va-muted);
      display: block;
      font-size: 0.85rem;
      margin-top: 2px;
    }

    #va-roi-calculator .va-table-empty {
      padding: 12px 14px;
      color: var(--va-muted);
      text-align: left;
    }

    @media (max-width: 768px) {
      #va-roi-calculator .va-table-head,
      #va-roi-calculator .va-table-row,
      #va-roi-calculator .va-table-foot {
        grid-template-columns: 1.6fr 1fr 1fr;
        grid-auto-rows: auto;
        grid-template-areas:
          "task task task"
          "owner weekly annual"
          "cost savings empty";
      }

      #va-roi-calculator .va-table-head span:nth-child(1),
      #va-roi-calculator .va-table-row span:nth-child(1),
      #va-roi-calculator .va-table-foot strong:nth-child(1) { grid-area: task; }
      #va-roi-calculator .va-table-head span:nth-child(2),
      #va-roi-calculator .va-table-row span:nth-child(2),
      #va-roi-calculator .va-table-foot span:nth-child(2) { grid-area: owner; }
      #va-roi-calculator .va-table-head span:nth-child(3),
      #va-roi-calculator .va-table-row span:nth-child(3),
      #va-roi-calculator .va-table-foot span:nth-child(3) { grid-area: weekly; }
      #va-roi-calculator .va-table-head span:nth-child(4),
      #va-roi-calculator .va-table-row span:nth-child(4),
      #va-roi-calculator .va-table-foot span:nth-child(4) { grid-area: annual; }
      #va-roi-calculator .va-table-head span:nth-child(5),
      #va-roi-calculator .va-table-row span:nth-child(5),
      #va-roi-calculator .va-table-foot span:nth-child(5) { grid-area: cost; }
      #va-roi-calculator .va-table-head span:nth-child(6),
      #va-roi-calculator .va-table-row span:nth-child(6),
      #va-roi-calculator .va-table-foot span:nth-child(6) { grid-area: savings; }
    }

    #va-roi-calculator .va-zone {
      position: absolute;
      width: 50%;
      height: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-weight: 700;
      font-size: 0.95rem;
      color: rgba(19, 64, 97, 0.35);
      z-index: 0;
      pointer-events: none;
    }

    #va-roi-calculator .va-zone.quick { background: rgba(244, 136, 71, 0.16); color: rgba(244, 136, 71, 0.65); }
    #va-roi-calculator .va-zone.bet { background: rgba(19, 64, 97, 0.12); color: rgba(19, 64, 97, 0.72); }
    #va-roi-calculator .va-zone.hobby { background: rgba(15, 31, 51, 0.08); color: rgba(82, 104, 128, 0.8); }
    #va-roi-calculator .va-zone.trap { background: rgba(201, 75, 75, 0.12); color: rgba(160, 59, 59, 0.8); }

    #va-roi-calculator .va-zone.quick { right: 0; bottom: 0; }
    #va-roi-calculator .va-zone.bet { right: 0; top: 0; }
    #va-roi-calculator .va-zone.hobby { left: 0; bottom: 0; }
    #va-roi-calculator .va-zone.trap { left: 0; top: 0; }

    #va-roi-calculator .va-ready-layout {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 16px;
      align-items: start;
    }

    #va-roi-calculator .va-info-card {
      background: var(--va-cream);
      border: 1px dashed var(--va-line);
      border-radius: var(--va-radius);
      padding: 14px;
      color: var(--va-primary);
    }

    #va-roi-calculator .va-info-card h4 {
      margin: 0 0 8px;
      font-size: 1rem;
    }

    #va-roi-calculator .va-info-card ul {
      margin: 0;
      padding-left: 18px;
      color: var(--va-muted);
      line-height: 1.5;
    }

    #va-roi-calculator .va-chip-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 10px;
      align-items: center;
    }

    #va-roi-calculator .va-chip {
      border: 1px solid var(--va-line);
      background: var(--va-cream);
      color: var(--va-primary);
      padding: 10px 12px;
      border-radius: 999px;
      cursor: pointer;
      text-align: center;
      font-weight: 600;
      transition: all 0.2s ease;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    #va-roi-calculator .va-chip:hover {
      background: rgba(19, 64, 97, 0.06);
      border-color: rgba(244, 136, 71, 0.4);
      color: var(--va-accent);
    }

    #va-roi-calculator .va-chip.active {
      background: linear-gradient(135deg, var(--va-accent), var(--va-accent-soft));
      color: #fff;
      border-color: var(--va-accent);
      box-shadow: 0 10px 24px rgba(244, 136, 71, 0.28);
    }

    #va-roi-calculator .va-ready-list {
      display: flex;
      flex-direction: column;
      gap: 14px;
      align-items: stretch;
    }

    #va-roi-calculator .inventory-layout {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 32px;
      align-items: start;
    }

    #va-roi-calculator .readiness-grid {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    #va-roi-calculator .readiness-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    #va-roi-calculator .va-ready-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    #va-roi-calculator .task-form-grid {
      display: grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap: 40px;
      align-items: start;
    }

    #va-roi-calculator .readiness-card {
      background: var(--va-cream);
      border: 1px solid var(--va-line);
      border-radius: 12px;
      padding: 26px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.04);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    #va-roi-calculator .readiness-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    #va-roi-calculator .readiness-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
    }

    @media (max-width: 900px) {
      #va-roi-calculator .task-form-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 600px) {
      #va-roi-calculator .va-ready-item {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    #va-roi-calculator .va-ready-label {
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
      color: var(--va-primary);
    }

    #va-roi-calculator .va-info {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 1px solid var(--va-muted);
      color: var(--va-primary);
      font-size: 0.75rem;
      cursor: help;
      background: var(--va-panel);
    }

    #va-roi-calculator .va-switch {
      position: relative;
      width: 52px;
      height: 26px;
      border-radius: 999px;
      border: none;
      background: rgba(19, 64, 97, 0.12);
      cursor: pointer;
      padding: 0;
      transition: all 0.2s ease;
      box-shadow: inset 0 1px 3px rgba(0,0,0,0.08);
    }

    #va-roi-calculator .va-switch-thumb {
      position: absolute;
      top: 3px;
      left: 3px;
      width: 20px;
      height: 20px;
      background: #fff;
      border-radius: 50%;
      transition: all 0.2s ease;
      box-shadow: 0 2px 8px rgba(0,0,0,0.16);
    }

    #va-roi-calculator .va-switch.on {
      background: linear-gradient(135deg, var(--va-accent), var(--va-accent-soft));
      box-shadow: 0 6px 18px rgba(244, 136, 71, 0.35);
    }

    #va-roi-calculator .va-switch.on .va-switch-thumb {
      left: 29px;
    }

    #va-roi-calculator .va-switch:active .va-switch-thumb {
      transform: scale(0.96);
    }

    #va-roi-calculator .soft-card {
      background: var(--va-cream);
      border: 1px solid var(--va-line);
      border-radius: 16px;
      box-shadow: 0 12px 30px rgba(19, 64, 97, 0.08);
    }

    #va-roi-calculator .priority-pill {
      display: inline-flex;
      align-items: center;
      padding: 6px 10px;
      border-radius: 999px;
      font-weight: 700;
      font-size: 0.9rem;
      border: 1px solid transparent;
    }
    #va-roi-calculator .priority-pill.quick { background: rgba(244, 136, 71, 0.14); color: #c05c29; border-color: rgba(244, 136, 71, 0.38); }
    #va-roi-calculator .priority-pill.bet { background: rgba(19, 64, 97, 0.12); color: #134061; border-color: rgba(19, 64, 97, 0.32); }
    #va-roi-calculator .priority-pill.hobby { background: rgba(15, 31, 51, 0.06); color: var(--va-muted); border-color: rgba(19, 64, 97, 0.16); }
    #va-roi-calculator .priority-pill.trap { background: rgba(201, 75, 75, 0.14); color: #a03b3b; border-color: rgba(201, 75, 75, 0.45); }

    #va-roi-calculator .classification-table .va-table-head,
    #va-roi-calculator .classification-table .va-table-row {
      grid-template-columns: 2fr 1fr 1fr 1fr 1fr 1fr 1fr;
    }

    #va-roi-calculator .va-info:hover::after,
    #va-roi-calculator .va-info:focus-visible::after {
      content: attr(data-tip);
      position: absolute;
      top: 120%;
      left: 50%;
      transform: translateX(-50%);
      background: var(--va-primary);
      color: #fff;
      padding: 6px 8px;
      border-radius: 8px;
      font-size: 0.8rem;
      line-height: 1.3;
      width: 180px;
      box-shadow: 0 10px 24px rgba(19, 64, 97, 0.24);
      z-index: 10;
      pointer-events: none;
    }

    #va-roi-calculator .va-range-wrap {
      padding: 0 4px;
    }

    #va-roi-calculator input[type="range"],
    #va-roi-calculator .va-range {
      -webkit-appearance: none;
      width: 100%;
      margin: 0;
      height: 10px;
      border-radius: 999px;
      background: rgba(217, 225, 234, 0.85);
      outline: none;
    }

    #va-roi-calculator input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--va-accent), var(--va-accent-soft));
      box-shadow: 0 6px 12px rgba(244, 136, 71, 0.35);
      cursor: pointer;
      border: 2px solid #fff;
    }

    #va-roi-calculator input[type="range"]::-moz-range-thumb {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--va-accent), var(--va-accent-soft));
      box-shadow: 0 6px 12px rgba(244, 136, 71, 0.35);
      cursor: pointer;
      border: 2px solid #fff;
    }

    #va-roi-calculator input[type="range"]::-webkit-slider-runnable-track {
      height: 8px;
      border-radius: 999px;
      background: linear-gradient(90deg, var(--va-accent), var(--va-accent-soft));
    }

    #va-roi-calculator input[type="range"]::-moz-range-track {
      height: 8px;
      border-radius: 999px;
      background: linear-gradient(90deg, var(--va-accent), var(--va-accent-soft));
    }

    @media (max-width: 768px) {
      #va-roi-calculator .va-shell { padding: 22px; }
      #va-roi-calculator .va-header { flex-direction: column; }
      #va-roi-calculator .va-title { font-size: 1.75rem; }
      #va-roi-calculator .va-roi { padding: 24px 14px 40px; }
      #va-roi-calculator .va-ready-layout { grid-template-columns: 1fr; }
      #va-roi-calculator .inventory-layout { grid-template-columns: 1fr; }
      #va-roi-calculator .readiness-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div id="va-roi-calculator">
  <div class="va-roi">
  <div class="va-hero">
    <div class="va-header">
      <div class="va-brand">
        <img src="assets/va-logo-wide.png" alt="Valid Agenda logo" class="va-logo" />
        <div>
          <p class="va-tagline">Valid Agenda ROI Toolkit</p>
          <h1 class="va-title">Automation ROI Calculator</h1>
          <p class="va-lede">
            Quickly size the time and cost of recurring work to decide if automation is worth it.
          </p>
        </div>
      </div>
      <div class="va-tag">AI that pays back</div>
    </div>

    <div class="va-card va-hero-card" id="part-1">
      <h3>How this works</h3>
      <div class="va-ready-layout">
        <div class="va-info-card" style="grid-column: span 2;">
          <h4>Use this to capture tasks and rank automation fit</h4>
          <ul>
            <li>List each workflow with time, frequency, and hourly cost.</li>
            <li>Toggle effort factors per task to reflect automation readiness.</li>
            <li>See total time and cost, plus a simple 50% automation savings view.</li>
            <li>Plot tasks by impact and effort to choose what to automate first.</li>
          </ul>
        </div>
      </div>
      <a class="va-proceed" href="#part-2">Start adding tasks</a>
    </div>
  </div>

  <div class="va-shell">

    <div class="va-card" id="part-2" style="margin-top:16px;">
      <h3>Workflow Inventory</h3>
      <p>Add each recurring task, save it, then add another. Effort factors live inside each task.</p>
      <form id="inventory-form" autocomplete="off">
        <div class="task-form-grid">
          <div class="left-col">
            <div class="va-field">
              <label>Task name </label>
              <input class="va-input" id="task-name" type="text" placeholder="e.g., Weekly reporting emails" />
            </div>
            <div class="va-grid" style="grid-template-columns: repeat(auto-fit,minmax(180px,1fr));">
              <div class="va-field">
                <label>Frequency per week</label>
                <input class="va-input" id="freq" type="number" min="0" step="1" placeholder="e.g., 5" />
              </div>
              <div class="va-field">
                <label>Minutes per task</label>
                <input class="va-input" id="minutes" type="number" min="0" step="0.5" placeholder="e.g., 20" />
              </div>
              <div class="va-field">
                <label>Hourly cost of the role ($)</label>
                <input class="va-input" id="hourly" type="number" min="0" step="1" placeholder="e.g., 60" />
              </div>
              <div class="va-field">
                <label>Role title</label>
                <input class="va-input" id="role" type="text" placeholder="e.g., Ops Manager" />
              </div>
            </div>
            <div class="va-field">
              <label style="flex-direction:column; align-items:flex-start; gap:4px;">
                <span>Pain level</span>
                <small title="Why it matters: higher pain means bigger urgency">How disruptive is this work?</small>
              </label>
              <input id="pain" type="hidden" value="5" />
              <div class="va-chip-group" id="pain-chips">
                <button type="button" class="va-chip" data-pain="1" data-label="Minor annoyance">Minor annoyance</button>
                <button type="button" class="va-chip" data-pain="3" data-label="Manageable">Manageable</button>
                <button type="button" class="va-chip" data-pain="5" data-label="Moderate">Moderate</button>
                <button type="button" class="va-chip" data-pain="7" data-label="Disruptive">Disruptive</button>
                <button type="button" class="va-chip" data-pain="10" data-label="Severe impact">Severe impact</button>
              </div>
              <div style="color:var(--va-muted);font-size:0.9rem;margin-top:6px;" hidden="true">Selected: <strong id="pain-display">Moderate</strong></div>
            </div>
          </div>
          <div class="right-col">
            <div class="readiness-card">
              <h3 style="margin:0;">Readiness to automate</h3>
              <p style="margin:0;color:var(--va-muted);font-size:0.95rem;">Turn on what’s true.<br>More on = easier to automate.</p>
              <div id="task-readiness-list" class="va-ready-list readiness-grid" style="margin-top:6px;"></div>
            </div>
          </div>
        </div>
        <div id="form-error" class="va-error" style="display:none;"></div>
      </form>
      <div class="va-footer" style="margin-top:10px;">
        <div style="color:var(--va-muted);">Save each task, then add another to compare.</div>
        <button class="va-cta" id="save-task-btn" type="button">Save task</button>
      </div>
      <div class="va-highlight soft-card" style="margin-top:12px;">
        <strong>Saved tasks</strong>
        <div id="task-list" style="margin-top:10px; display:flex; flex-direction:column; gap:10px;"></div>
        <div id="task-empty" style="color:var(--va-muted); font-size:0.95rem;">No tasks saved yet.</div>
      </div>
      <a class="va-proceed" href="#part-3">View ROI summary</a>
    </div>

    <div class="va-card" id="part-3" style="margin-top:16px;">
      <h3>ROI Summary</h3>
      <p>See time and cost for each saved task, plus a 50% automation savings view.</p>
      <div class="va-highlight soft-card">
        <div style="display:flex;justify-content:space-between;gap:8px;flex-wrap:wrap;align-items:center;">
          <div>
            <div style="color:var(--va-muted);font-size:0.9rem;">Current annual cost</div>
            <div style="font-size:1.5rem;font-weight:800;" id="annual-cost">$0 / year</div>
          </div>
          <div class="va-pill" id="weekly-hours">0 hrs / week</div>
        </div>
        <div class="va-pill" style="margin-top:10px;">Annual hours: <span id="annual-hours" style="margin-left:6px;">0</span></div>
      </div>
      <div class="va-table" aria-live="polite">
        <div class="va-table-head">
          <span>Task</span><span>Owner</span><span>Weekly hrs</span><span>Annual hrs</span><span>Annual cost</span><span>Savings (50%)</span>
        </div>
        <div id="task-table-body" class="va-table-body"></div>
        <div id="task-table-empty" class="va-table-empty">Add tasks to see ROI.</div>
        <div class="va-table-foot" id="task-totals">
          <strong>Totals</strong><span></span><span id="total-weekly">0</span><span id="total-annual">0</span><span id="total-cost">$0</span><span id="total-savings">$0</span>
        </div>
      </div>
      <div class="va-chart">
        <div class="va-chart-bar">
          <span style="width:120px;color:var(--va-muted);font-size:0.9rem;">Current cost</span>
          <div class="va-bar"><span id="cost-bar"></span></div>
        </div>
        <div class="va-chart-bar">
          <span style="width:120px;color:var(--va-muted);font-size:0.9rem;">If automated (50%)</span>
          <div class="va-bar"><span id="savings-bar" style="background:var(--va-accent);"></span></div>
        </div>
        <div style="color:var(--va-muted);font-size:0.9rem;">Estimated savings at 50% automation: <strong id="savings-figure">$0</strong></div>
      </div>
      <a class="va-proceed" href="#part-4">View decision matrix</a>
    </div>

    <div class="va-card" id="part-4" style="margin-top:16px;">
      <h3>Decision Matrix</h3>
      <p>Impact uses annual cost; effort uses your readiness toggles. Hover dots to see details.</p>
      <div class="va-chart soft-card" style="margin-top:12px;">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap;margin-bottom:6px;">
          <strong>Portfolio view</strong>
          <small style="color:var(--va-muted);">Each dot is a task</small>
        </div>
          <div id="matrix-plot" style="position:relative;">
            <canvas id="decision-matrix-canvas" style="width:100%;max-width:100%;height:360px;display:block;border:1px solid var(--va-line);border-radius:12px;"></canvas>
            <div style="position:absolute;left:8px;top:8px;color:var(--va-muted);font-size:0.85rem;">Effort ↑ (more)</div>
            <div style="position:absolute;right:8px;bottom:8px;color:var(--va-muted);font-size:0.85rem;">Impact →</div>
          </div>
      </div>
      <div class="va-table classification-table" style="margin-top:12px;">
        <div class="va-table-head">
          <span>Task</span><span>Owner</span><span>Impact</span><span>Effort</span><span>Annual cost</span><span>Savings (50%)</span><span>Priority</span>
        </div>
        <div id="classification-table" class="va-table-body"></div>
        <div id="classification-empty" class="va-table-empty">Add tasks to plot them on the matrix.</div>
      </div>
    </div>

    <div class="va-card va-download-banner" id="part-3b" style="margin-top:16px;">
      <div class="va-download-heading">
        <span style="color:#fff;">Download a PDF copy</span>
      </div>
      <p class="va-download-note">Grab your ROI summary PDF and we’ll follow up with a tailored walkthrough.</p>
      <form id="lead-form" class="va-lead-form" novalidate>
        <div class="va-download-grid">
          <div class="va-field">
            <label for="lead-first-name" style="color:#fff;">First name</label>
            <input class="va-input" id="lead-first-name" name="firstName" type="text" placeholder="Jordan" required />
          </div>
          <div class="va-field">
            <label for="lead-last-name" style="color:#fff;">Last name</label>
            <input class="va-input" id="lead-last-name" name="lastName" type="text" placeholder="Lee" required />
          </div>
          <div class="va-field va-field-role">
            <label for="lead-role" style="color:#fff;">Role</label>
            <select class="va-select" id="lead-role" name="role" required>
              <option value="" disabled selected hidden>Select a role</option>
              <option>Owner / Founder</option>
              <option>General Manager</option>
              <option>Operations</option>
              <option>Sales</option>
              <option>Marketing</option>
              <option>Finance / Admin</option>
              <option>IT / Technical</option>
              <option>Other</option>
            </select>
          </div>
          <div class="va-field va-field-email">
            <label for="lead-email" style="color:#fff;">Work email</label>
            <input class="va-input" id="lead-email" name="email" type="email" placeholder="you@company.com" required />
          </div>
        </div>
        <div class="va-field">
          <label class="va-checkbox" for="lead-consent" style="color:#fff;" align="left">
            <input id="lead-consent" type="checkbox" />
            <span style="color:#fff;" >I agree to receive communications from Valid Agenda about automation ROI and services.</span>
          </label>
        </div>
        <div class="va-lead-actions">
          <button class="va-cta va-download-cta" id="lead-submit" type="submit">Download PDF</button>
          <div id="lead-status" class="va-form-status" role="status" aria-live="polite"></div>
        </div>
      </form>
    </div>

    <div class="va-card va-next-strip" style="margin-top: 16px; box-shadow:none;">
      <h3>Next steps</h3>
      <p>Valid Agenda is here with a range of services to help you get started.</p>
      <div class="va-matrix">
        <div class="va-highlight">
          <strong>Teach</strong>
          <p>Coaching so your team can build simple automations confidently.</p>
        </div>
        <div class="va-highlight">
          <strong>Evaluate</strong>
          <p>ROI-first assessment to find the best opportunities and sequence them.</p>
        </div>
        <div class="va-highlight">
          <strong>Deliver</strong>
          <p>Low or no-code builds that are easy to run and tied to measurable outcomes.</p>
        </div>
      </div>
      <div class="va-footer">
        <div style="color:var(--va-muted);">Want a quick readout? We’ll map the value math to a delivery plan.</div>
        <button class="va-cta" type="button" onclick="window.open('https://validagenda.com/book','_blank','noopener');">Book Your Alignment Call Now</button>
      </div>
    </div>
    </div>
  </div>

  <footer class="va-site-footer">
    <div class="va-site-footer-row">
      <div class="va-site-footer-brand">
        <img src="assets/va-logo-wide.png" alt="Valid Agenda logo">
        <p class="va-site-footer-tagline">TEACH // EVALUATE // DELIVER</p>
      </div>
      <div class="va-site-footer-contact">
        <h4>Contact</h4>
        <p>David Pengelley, Founder</p>
        <p><a href="tel:+61256570400">+61 2 5657 0400</a></p>
        <div class="va-site-footer-social">
          <a href="https://www.linkedin.com/in/davidpen/" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true"><path d="M3.29 14H.42V5.2h2.87V14zM1.85 4.03C.83 4.03 0 3.19 0 2.17 0 1.16.83.31 1.85.31c1.01 0 1.85.85 1.85 1.86 0 1.02-.84 1.86-1.85 1.86zM16 14h-2.86v-4.3c0-1.03-.02-2.36-1.44-2.36-1.44 0-1.67 1.12-1.67 2.28V14H7.17V5.2h2.75v1.2h.04c.38-.72 1.3-1.48 2.67-1.48 2.86 0 3.38 1.88 3.38 4.33V14z"/></svg>
          </a>
          <a href="https://www.youtube.com/@ValidAgenda" target="_blank" rel="noopener noreferrer" aria-label="YouTube">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M23.5 6.2s-.2-1.7-.8-2.4c-.8-.8-1.6-.8-2-0.8C17.3 2.8 12 2.8 12 2.8h-.1s-5.3 0-8.7.2c-.5.1-1.3.1-2 0.8-.6.7-.8 2.4-.8 2.4S0 8.1 0 10v1.9c0 1.9.2 3.8.2 3.8s.2 1.7.8 2.4c.8.8 1.9.8 2.4.9 1.7.2 7 .2 7 .2s5.3 0 8.7-.2c.5-.1 1.3-.1 2-.8.6-.7.8-2.4.8-2.4s.2-1.9.2-3.8V10c0-1.9-.2-3.8-.2-3.8zM9.6 13.9V8.1l5.2 2.9-5.2 2.9z"/></svg>
          </a>
        </div>
      </div>
      <div class="va-site-footer-location">
        <h4>Location</h4>
        <p>Sydney, NSW</p>
      </div>
    </div>
    <div class="va-site-footer-bottom">
      <p class="va-site-footer-meta">© 2025 Valid Agenda Pty Ltd. All Rights Reserved.</p>
      <div class="va-site-footer-links">
        <a href="https://www.validagenda.com/privacy-policy" target="_blank" rel="noopener noreferrer">Privacy Policy</a>
        <span style="color:#f9a66c;">|</span>
        <a href="https://www.validagenda.com/terms-of-service" target="_blank" rel="noopener noreferrer">Terms of Service</a>
      </div>
    </div>
  </footer>

</div>
</div>

  <script>
    // Encapsulate logic to avoid globals
    (() => {
      const WEBHOOK_URL = "https://hooks.validagenda.dev/webhook/eb31e5cf-774c-4aa1-b914-8b5fa20be96c";
      const MEETING_URL = "https://validagenda.com/book";
      const LOGO_DATA =
        "data:image/png;base64,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AQAAAIAEAAADoAQAAQAAAKABAAAAAAAAWE1QIHoDAAA8P3hwYWNrZXQgYmVnaW49J++7vycgaWQ9J1c1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCc/Pgo8eDp4bXBtZXRhIHhtbG5zOng9J2Fkb2JlOm5zOm1ldGEvJyB4OnhtcHRrPSdJbWFnZTo6RXhpZlRvb2wgMTIuNTcnPgo8cmRmOlJERiB4bWxuczpyZGY9J2h0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMnPgoKIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgeG1sbnM6QXR0cmliPSdodHRwOi8vbnMuYXR0cmlidXRpb24uY29tL2Fkcy8xLjAvJz4KICA8QXR0cmliOkFkcz4KICAgPHJkZjpTZXE+CiAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9J1Jlc291cmNlJz4KICAgICA8QXR0cmliOkNyZWF0ZWQ+MjAyNS0xMS0yNjwvQXR0cmliOkNyZWF0ZWQ+CiAgICAgPEF0dHJpYjpFeHRJZD42ZWM1N2Q4Ny1mYTRmLTQwZDMtYmU2NC1jM2NlNzRiMTRlMjA8L0F0dHJpYjpFeHRJZD4KICAgICA8QXR0cmliOkZiSWQ+NTI1MjY1OTE0MTc5NTgwPC9BdHRyaWI6RmJJZD4KICAgICA8QXR0cmliOlRvdWNoVHlwZT4yPC9BdHRyaWI6VG91Y2hUeXBlPgogICAgPC9yZGY6bGk+CiAgIDwvcmRmOlNlcT4KICA8L0F0dHJpYjpBZHM+CiA8L3JkZjpEZXNjcmlwdGlvbj4KCiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0nJwogIHhtbG5zOmRjPSdodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyc+CiAgPGRjOnRpdGxlPgogICA8cmRmOkFsdD4KICAgIDxyZGY6bGkgeG1sOmxhbmc9J3gtZGVmYXVsdCc+VmFsaWQgQWdlbmRhIFlvdVR1YmUgVGh1bWJuYWlscyAtIDE8L3JkZjpsaT4KICAgPC9yZGY6QWx0PgogIDwvZGM6dGl0bGU+CiA8L3JkZjpEZXNjcmlwdGlvbj4KPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KPD94cGFja2V0IGVuZD0ncic/Pg==";

      const readinessChecks = [
        { id: "documented", label: "Easy to explain", tip: "" },
        { id: "digital", label: "Everything is already digital", tip: "" },
        { id: "repeatable", label: "Happens the same way each time", tip: "" },
        { id: "frequency", label: "Safe to automate", tip: "" },
        { id: "access", label: "Someone can approve it", tip: "" },
      ];

      const els = {
        weeklyHours: document.getElementById("weekly-hours"),
        annualHours: document.getElementById("annual-hours"),
        annualCost: document.getElementById("annual-cost"),
        savingsFigure: document.getElementById("savings-figure"),
        costBar: document.getElementById("cost-bar"),
        savingsBar: document.getElementById("savings-bar"),
        painInput: document.getElementById("pain"),
        painDisplay: document.getElementById("pain-display"),
        painChips: Array.from(document.querySelectorAll("#pain-chips .va-chip")),
        formError: document.getElementById("form-error"),
        saveTaskBtn: document.getElementById("save-task-btn"),
        taskReadinessList: document.getElementById("task-readiness-list"),
        taskList: document.getElementById("task-list"),
        taskEmpty: document.getElementById("task-empty"),
        matrixPlot: document.getElementById("matrix-plot"),
        matrixCanvas: document.getElementById("decision-matrix-canvas"),
        taskTableBody: document.getElementById("task-table-body"),
        taskTableEmpty: document.getElementById("task-table-empty"),
        totalWeekly: document.getElementById("total-weekly"),
        totalAnnual: document.getElementById("total-annual"),
        totalCost: document.getElementById("total-cost"),
        totalSavings: document.getElementById("total-savings"),
        classificationTable: document.getElementById("classification-table"),
        classificationEmpty: document.getElementById("classification-empty"),
        leadForm: document.getElementById("lead-form"),
        leadFirstName: document.getElementById("lead-first-name"),
        leadLastName: document.getElementById("lead-last-name"),
        leadRole: document.getElementById("lead-role"),
        leadEmail: document.getElementById("lead-email"),
        leadConsent: document.getElementById("lead-consent"),
        leadStatus: document.getElementById("lead-status"),
        leadSubmit: document.getElementById("lead-submit"),
        fields: {
          task: document.getElementById("task-name"),
          freq: document.getElementById("freq"),
          minutes: document.getElementById("minutes"),
          hourly: document.getElementById("hourly"),
          role: document.getElementById("role"),
        },
      };

      const state = {
        formReadiness: {},
        values: {
          task: "",
          freq: 0,
          minutes: 0,
          hourly: 0,
          role: "",
          pain: 5,
        },
        tasks: [],
        editingId: null,
      };

      const STORAGE_KEY = "va-roi-state";
      let matrixDots = [];

      function getFormTask() {
        return {
          id: "current",
          task: els.fields.task.value.trim(),
          freq: Number(els.fields.freq.value) || 0,
          minutes: Number(els.fields.minutes.value) || 0,
          hourly: Number(els.fields.hourly.value) || 0,
          role: els.fields.role.value.trim(),
          pain: Number(els.painInput.value) || 5,
          readiness: { ...state.formReadiness },
        };
      }

      function formatCurrency(value) {
        if (!isFinite(value)) return "$0";
        const rounded = Math.round(value);
        const sign = rounded < 0 ? "-" : "";
        return `${sign}$${Math.abs(rounded).toLocaleString()}`;
      }

      function percentOf(max, value) {
        if (max <= 0) return 0;
        return Math.min(100, Math.round((value / max) * 100));
      }

      function validateEmail(value) {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(value).trim());
      }

      function setLeadStatus(message, type = "") {
        if (!els.leadStatus) return;
        els.leadStatus.textContent = message || "";
        els.leadStatus.className = "va-form-status" + (type ? ` ${type}` : "");
      }

      function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
        const words = text.split(" ");
        let line = "";
        for (let n = 0; n < words.length; n++) {
          const testLine = line + words[n] + " ";
          const metrics = ctx.measureText(testLine);
          if (metrics.width > maxWidth && n > 0) {
            ctx.fillText(line, x, y);
            line = words[n] + " ";
            y += lineHeight;
          } else {
            line = testLine;
          }
        }
        ctx.fillText(line, x, y);
        return y;
      }

      function drawRoundedRect(ctx, x, y, w, h, r = 16) {
        if (ctx.roundRect) {
          ctx.beginPath();
          ctx.roundRect(x, y, w, h, r);
        } else {
          ctx.beginPath();
          ctx.moveTo(x + r, y);
          ctx.lineTo(x + w - r, y);
          ctx.quadraticCurveTo(x + w, y, x + w, y + r);
          ctx.lineTo(x + w, y + h - r);
          ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
          ctx.lineTo(x + r, y + h);
          ctx.quadraticCurveTo(x, y + h, x, y + h - r);
          ctx.lineTo(x, y + r);
          ctx.quadraticCurveTo(x, y, x + r, y);
        }
      }

      function drawMatrixOnCanvas(ctx, area, tasks) {
        const { x, y, width, height } = area;
        ctx.save();
        ctx.translate(x, y);
        ctx.fillStyle = "#f5f7fa";
        ctx.fillRect(0, 0, width, height);
        ctx.strokeStyle = "#d9e1ea";
        ctx.strokeRect(0, 0, width, height);

        // quadrants
        ctx.fillStyle = "rgba(201,75,75,0.08)";
        ctx.fillRect(0, 0, width / 2, height / 2);
        ctx.fillStyle = "rgba(19,64,97,0.08)";
        ctx.fillRect(width / 2, 0, width / 2, height / 2);
        ctx.fillStyle = "rgba(15,31,51,0.06)";
        ctx.fillRect(0, height / 2, width / 2, height / 2);
        ctx.fillStyle = "rgba(244,136,71,0.12)";
        ctx.fillRect(width / 2, height / 2, width / 2, height / 2);

        ctx.strokeStyle = "#cdd6e0";
        ctx.beginPath();
        ctx.moveTo(width / 2, 0);
        ctx.lineTo(width / 2, height);
        ctx.moveTo(0, height / 2);
        ctx.lineTo(width, height / 2);
        ctx.stroke();

        ctx.fillStyle = "#526880";
        ctx.font = "bold 16px Manrope, Poppins, sans-serif";
        ctx.fillText("Strategic Bet", width * 0.65, height * 0.18);
        ctx.fillText("Trap", width * 0.12, height * 0.18);
        ctx.fillText("Hobby", width * 0.12, height * 0.82);
        ctx.fillText("Quick Win", width * 0.65, height * 0.82);
        ctx.font = "600 14px Manrope, sans-serif";
        ctx.fillText("Effort ↑", 4, 16);
        ctx.fillText("Impact →", width - 90, height - 8);

        const IMPACT_FLOOR = 20000;
        const maxImpact = Math.max(...tasks.map((t) => t.metrics.annualCost), IMPACT_FLOOR);

        tasks.forEach((task) => {
          const impactRatio = Math.min(1, Math.max(0, task.metrics.annualCost / maxImpact));
          const effortRatio = Math.min(1, Math.max(0, (1 - task.readinessScore) + (10 - task.pain) / 25));
          const px = impactRatio * width;
          const py = (1 - effortRatio) * height;
          ctx.beginPath();
          ctx.arc(px, py, 8, 0, Math.PI * 2);
          const badge = task.priorityClass;
          ctx.fillStyle =
            badge === "quick" ? "#f48847" : badge === "bet" ? "#134061" : badge === "trap" ? "#c94b4b" : "rgba(82,104,128,0.9)";
          ctx.fill();
          ctx.lineWidth = 2;
          ctx.strokeStyle = "#fff";
          ctx.stroke();
        });

        ctx.restore();
      }

      function loadImage(src) {
        return new Promise((resolve) => {
          const img = new Image();
          img.crossOrigin = "anonymous";
          img.onload = () => resolve(img);
          img.onerror = () => resolve(null);
          img.src = src;
        });
      }

      async function loadQrImage(url) {
        try {
          const res = await fetch(`https://api.qrserver.com/v1/create-qr-code/?size=340x340&data=${encodeURIComponent(url)}`);
          const blob = await res.blob();
          const objectUrl = URL.createObjectURL(blob);
          const img = await loadImage(objectUrl);
          URL.revokeObjectURL(objectUrl);
          return img;
        } catch (err) {
          console.error("QR load failed", err);
          return null;
        }
      }

      async function renderReportCanvas(tasksWithMeta, totals) {
        const canvas = document.createElement("canvas");
        canvas.width = 1200;
        canvas.height = 2000;
        const ctx = canvas.getContext("2d");
        const [logoImg, qr] = await Promise.all([loadImage(LOGO_DATA), loadQrImage(MEETING_URL)]);

        // background
        ctx.fillStyle = "#f7f9fb";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // header
        const grad = ctx.createLinearGradient(0, 0, canvas.width, 0);
        grad.addColorStop(0, "#134061");
        grad.addColorStop(1, "#0f2b45");
        ctx.fillStyle = grad;
        ctx.fillRect(0, 0, canvas.width, 180);
        ctx.fillStyle = "#fff";
        ctx.font = "bold 34px Poppins, sans-serif";
        ctx.fillText("Automation ROI Report", 36, 70);
        ctx.font = "20px Manrope, sans-serif";
        ctx.fillText("Valid Agenda ROI Summary & Decision Matrix", 36, 110);
        ctx.fillStyle = "rgba(255,255,255,0.88)";
        ctx.fillText("Book a session: " + MEETING_URL, 36, 150);
        if (logoImg) {
          const logoW = 220;
          const aspect = logoImg.width ? logoImg.width / logoImg.height : 3.2;
          const logoH = logoW / aspect;
          ctx.drawImage(logoImg, canvas.width - logoW - 36, 36, logoW, logoH);
        }

        // summary card
        ctx.fillStyle = "#fff";
        ctx.strokeStyle = "#d9e1ea";
        ctx.lineWidth = 2;
        drawRoundedRect(ctx, 36, 210, canvas.width - 72, 180, 18);
        ctx.fill();
        ctx.stroke();
        ctx.fillStyle = "#134061";
        ctx.font = "700 24px Poppins, sans-serif";
        ctx.fillText("ROI Summary", 60, 250);

        const stats = [
          { label: "Current annual cost", value: `${formatCurrency(totals.annualCost)}` },
          { label: "Estimated savings (50%)", value: `${formatCurrency(totals.savings)}` },
          { label: "Weekly hours", value: `${totals.weeklyHours.toFixed(1)} hrs` },
          { label: "Annual hours", value: `${totals.annualHours.toFixed(1)} hrs` },
        ];
        ctx.font = "600 16px Manrope, sans-serif";
        stats.forEach((stat, i) => {
          const boxWidth = (canvas.width - 120) / stats.length;
          const bx = 60 + i * boxWidth;
          const by = 280;
          ctx.fillStyle = "#526880";
          ctx.fillText(stat.label, bx, by);
          ctx.fillStyle = "#f48847";
          ctx.font = "800 24px Poppins, sans-serif";
          ctx.fillText(stat.value, bx, by + 32);
          ctx.font = "600 16px Manrope, sans-serif";
        });

        // tasks table
        const tableTop = 430;
        const tableHeight = 360;
        ctx.fillStyle = "#fff";
        drawRoundedRect(ctx, 36, tableTop, canvas.width - 72, tableHeight, 18);
        ctx.fill();
        ctx.strokeStyle = "#d9e1ea";
        ctx.stroke();

        ctx.fillStyle = "#134061";
        ctx.font = "700 22px Poppins, sans-serif";
        ctx.fillText("Top Tasks", 60, tableTop + 40);

        const headers = ["Task", "Owner", "Annual Cost", "Savings (50%)", "Priority"];
        const colXs = [60, 420, 690, 920, 1090];
        ctx.fillStyle = "#f5f7fa";
        ctx.fillRect(48, tableTop + 50, canvas.width - 96, 34);
        ctx.fillStyle = "#134061";
        ctx.font = "700 14px Manrope, sans-serif";
        headers.forEach((h, idx) => ctx.fillText(h, colXs[idx], tableTop + 74));

        const rows = tasksWithMeta.slice(0, 10);
        ctx.font = "600 14px Manrope, sans-serif";
        rows.forEach((task, row) => {
          const baseY = tableTop + 102 + row * 30;
          if (row % 2 === 0) {
            ctx.fillStyle = "#f9fbfd";
            ctx.fillRect(48, baseY - 16, canvas.width - 96, 30);
          }
          ctx.fillStyle = "#0d2236";
          ctx.fillText(task.task || "Untitled", colXs[0], baseY);
          ctx.fillText(task.role || "Owner", colXs[1], baseY);
          ctx.fillText(formatCurrency(task.metrics.annualCost), colXs[2], baseY);
          ctx.fillText(formatCurrency(task.metrics.savings), colXs[3], baseY);
          ctx.fillText(task.priority, colXs[4], baseY);
        });

        // Decision matrix
        const matrixArea = { x: 36, y: 840, width: canvas.width - 72, height: 420 };
        ctx.fillStyle = "#fff";
        drawRoundedRect(ctx, matrixArea.x, matrixArea.y, matrixArea.width, matrixArea.height + 100, 18);
        ctx.fill();
        ctx.strokeStyle = "#d9e1ea";
        ctx.stroke();
        ctx.fillStyle = "#134061";
        ctx.font = "700 22px Poppins, sans-serif";
        ctx.fillText("Decision Matrix", matrixArea.x + 24, matrixArea.y + 36);
        drawMatrixOnCanvas(ctx, { x: matrixArea.x + 24, y: matrixArea.y + 70, width: matrixArea.width - 48, height: matrixArea.height - 40 }, tasksWithMeta);

        // Sales pitch block
        const pitchTop = 1380;
        ctx.fillStyle = "#fff";
        drawRoundedRect(ctx, 36, pitchTop, canvas.width - 72, 200, 18);
        ctx.fill();
        ctx.strokeStyle = "#d9e1ea";
        ctx.stroke();
        ctx.fillStyle = "#134061";
        ctx.font = "700 22px Poppins, sans-serif";
        ctx.fillText("How Valid Agenda helps", 60, pitchTop + 36);
        ctx.fillStyle = "#526880";
        ctx.font = "16px Manrope, sans-serif";
        const pitch = "We map your automation opportunities to ROI, then deliver quick wins and repeatable playbooks. Coaching, assessments, and delivery sprints keep risk low and value high.";
        wrapText(ctx, pitch, 60, pitchTop + 66, canvas.width - 120, 24);

        // Booking block with QR
        const bookTop = 1640;
        ctx.fillStyle = "#fff";
        drawRoundedRect(ctx, 36, bookTop, canvas.width - 72, 260, 18);
        ctx.fill();
        ctx.strokeStyle = "#d9e1ea";
        ctx.stroke();
        ctx.fillStyle = "#134061";
        ctx.font = "700 20px Poppins, sans-serif";
        ctx.fillText("Book an Evaluate Session", 60, bookTop + 36);
        ctx.fillStyle = "#0d2236";
        ctx.font = "16px Manrope, sans-serif";
        wrapText(ctx, MEETING_URL, 60, bookTop + 64, canvas.width - 420, 22);

        if (qr) {
          ctx.drawImage(qr, canvas.width - 320, bookTop + 20, 240, 240);
        } else {
          ctx.strokeStyle = "#d9e1ea";
          ctx.strokeRect(canvas.width - 320, bookTop + 20, 240, 240);
          ctx.fillStyle = "#526880";
          ctx.fillText("QR unavailable", canvas.width - 270, bookTop + 150);
        }

        return canvas;
      }

      function buildPdfFromCanvas(canvas) {
        const dataUrl = canvas.toDataURL("image/jpeg", 0.9);
        const base64 = dataUrl.split(",")[1];
        const binary = atob(base64);
        const imgBytes = new Uint8Array(binary.length);
        for (let i = 0; i < binary.length; i += 1) imgBytes[i] = binary.charCodeAt(i);

        const width = canvas.width;
        const height = canvas.height;
        const encoder = new TextEncoder();
        const chunks = [];
        const offsets = [0];
        let pos = 0;
        const push = (chunk) => {
          chunks.push(chunk);
          pos += chunk.length;
        };
        const addObject = (id, body) => {
          offsets[id] = pos;
          push(encoder.encode(`${id} 0 obj\n`));
          push(body);
          push(encoder.encode("\nendobj\n"));
        };
        const concat = (parts) => {
          const total = parts.reduce((acc, p) => acc + p.length, 0);
          const out = new Uint8Array(total);
          let offset = 0;
          parts.forEach((p) => {
            out.set(p, offset);
            offset += p.length;
          });
          return out;
        };

        push(encoder.encode("%PDF-1.4\n"));

        const imageStream = concat([
          encoder.encode(`<< /Type /XObject /Subtype /Image /Width ${width} /Height ${height} /ColorSpace /DeviceRGB /BitsPerComponent 8 /Filter /DCTDecode /Length ${imgBytes.length} >>\nstream\n`),
          imgBytes,
          encoder.encode("\nendstream"),
        ]);

        const contentStreamData = encoder.encode(`q\n${width} 0 0 ${height} 0 0 cm\n/Im0 Do\nQ`);
        const contentStream = concat([
          encoder.encode(`<< /Length ${contentStreamData.length} >>\nstream\n`),
          contentStreamData,
          encoder.encode("\nendstream"),
        ]);

        addObject(1, encoder.encode("<< /Type /Catalog /Pages 2 0 R >>"));
        addObject(2, encoder.encode("<< /Type /Pages /Count 1 /Kids [3 0 R] >>"));
        addObject(
          3,
          encoder.encode(
            `<< /Type /Page /Parent 2 0 R /MediaBox [0 0 ${width} ${height}] /Resources << /XObject << /Im0 4 0 R >> >> /Contents 5 0 R >>`
          )
        );
        addObject(4, imageStream);
        addObject(5, contentStream);

        const xrefStart = pos;
        push(encoder.encode(`xref\n0 6\n`));
        push(encoder.encode("0000000000 65535 f \n"));
        for (let i = 1; i <= 5; i += 1) {
          push(encoder.encode(`${String(offsets[i]).padStart(10, "0")} 00000 n \n`));
        }
        push(encoder.encode(`trailer\n<< /Size 6 /Root 1 0 R >>\nstartxref\n${xrefStart}\n%%EOF`));

        return new Blob(chunks, { type: "application/pdf" });
      }

      async function buildReportPdf(tasksWithMeta, totals) {
        const canvas = await renderReportCanvas(tasksWithMeta, totals);
        return buildPdfFromCanvas(canvas);
      }

      function downloadBlob(blob, filename) {
        const url = URL.createObjectURL(blob);
        const link = document.createElement("a");
        link.href = url;
        link.download = filename;
        document.body.appendChild(link);
        link.click();
        link.remove();
        setTimeout(() => URL.revokeObjectURL(url), 500);
      }

      function blobToBase64(blob) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onloadend = () => {
            const res = reader.result || "";
            const [, data = ""] = String(res).split(",");
            resolve(data);
          };
          reader.onerror = (err) => reject(err);
          reader.readAsDataURL(blob);
        });
      }

      function setPainValue(val, silent = false) {
        els.painInput.value = val;
        els.painChips.forEach((chip) => {
          const isActive = Number(chip.dataset.pain) === Number(val);
          chip.classList.toggle("active", isActive);
          if (isActive && chip.dataset.label) {
            els.painDisplay.textContent = chip.dataset.label;
          }
        });
        if (!silent) update();
      }

      function renderTaskReadinessForm() {
        els.taskReadinessList.innerHTML = "";
        readinessChecks.forEach((check) => {
          const item = document.createElement("div");
          item.className = "va-ready-item";

          const labelRow = document.createElement("div");
          labelRow.className = "va-ready-label";
          const label = document.createElement("span");
          label.textContent = check.label;
          const info = document.createElement("span");
          info.className = "va-info";
          info.textContent = "";
          info.title = "";
          info.setAttribute("data-tip", "");
          info.style.display = "none";
          labelRow.appendChild(label);
          labelRow.appendChild(info);

          const switchBtn = document.createElement("button");
          switchBtn.type = "button";
          switchBtn.className = "va-switch";
          const thumb = document.createElement("span");
          thumb.className = "va-switch-thumb";
          switchBtn.appendChild(thumb);

          const applyState = (val) => {
            switchBtn.classList.toggle("on", val === true);
          };

          const setState = (val) => {
            state.formReadiness[check.id] = val;
            applyState(val);
            saveState();
            update();
          };

          switchBtn.addEventListener("click", () => setState(!state.formReadiness[check.id]));

          const saved = state.formReadiness[check.id];
          applyState(saved === true);
          if (saved !== true) state.formReadiness[check.id] = false;

          item.appendChild(labelRow);
          item.appendChild(switchBtn);
          els.taskReadinessList.appendChild(item);
        });
      }

      function validateNumbers() {
        const { freq, minutes, hourly } = els.fields;
        const values = [freq, minutes, hourly];
        const invalid = values.some((input) => Number(input.value) < 0);
        if (invalid) {
          els.formError.style.display = "block";
          els.formError.textContent = "Inputs cannot be negative.";
          return false;
        }
        els.formError.style.display = "none";
        return true;
      }

      function validateForSave() {
        const baseValid = validateNumbers();
        const missingName = getFormTask().task === "";
        if (!baseValid || missingName) {
          els.formError.style.display = "block";
          els.formError.textContent = missingName ? "Give the task a name before saving." : els.formError.textContent;
          return false;
        }
        return true;
      }

      function getReadinessScore(readiness = {}) {
        const total = readinessChecks.length;
        const yesCount = readinessChecks.reduce((acc, check) => acc + (readiness[check.id] ? 1 : 0), 0);
        const score = total ? yesCount / total : 0;
        const effort = score >= 0.6 ? "Low" : score >= 0.4 ? "Medium" : "High";
        return { score, effort };
      }

      function calculateTaskMetrics(task) {
        const weeklyHours = (task.freq * task.minutes) / 60;
        const annualHours = weeklyHours * 52;
        const annualCost = annualHours * task.hourly;
        const savings = annualCost * 0.5;
        return { weeklyHours, annualHours, annualCost, savings };
      }

      function calculateTotals(tasks) {
        return tasks.reduce(
          (acc, task) => {
            const m = calculateTaskMetrics(task);
            acc.weeklyHours += m.weeklyHours;
            acc.annualHours += m.annualHours;
            acc.annualCost += m.annualCost;
            acc.savings += m.savings;
            return acc;
          },
          { weeklyHours: 0, annualHours: 0, annualCost: 0, savings: 0 }
        );
      }

      function getDecisionMeta(impactValue, effortScore) {
        const impactLevel = impactValue >= 20000 ? "High" : "Low";
        const effortLevel = effortScore >= 0.6 ? "Low" : effortScore >= 0.4 ? "Medium" : "High";

        let badgeClass = "hobby";
        let label = "Low Impact + Low Effort";
        let note = "Focus where the value is meaningful and the path to automate is clear.";

        if (impactLevel === "High" && effortLevel === "Low") {
          badgeClass = "quick";
          label = "Quick Win";
          note = "High dollar impact with a clear path — act fast.";
        } else if (impactLevel === "High" && effortLevel !== "Low") {
          badgeClass = "bet";
          label = "Strategic Bet";
          note = "Big upside, but plan for change management or tech dependencies.";
        } else if (impactLevel === "Low" && effortLevel === "Low") {
          badgeClass = "hobby";
          label = "Hobby";
          note = "Light lift, low value. Only automate if it unlocks learning or morale.";
        } else {
          badgeClass = "trap";
          label = "Trap";
          note = "Low value and high effort. Park it or simplify before automating.";
        }

        return { badgeClass, label, note, impactLevel, effortLevel };
      }

      function saveState() {
        try {
          const payload = {
            values: {
              task: els.fields.task.value,
              freq: els.fields.freq.value,
              minutes: els.fields.minutes.value,
              hourly: els.fields.hourly.value,
              role: els.fields.role.value,
              pain: els.painInput.value,
            },
            tasks: state.tasks,
            editingId: state.editingId,
            formReadiness: state.formReadiness,
          };
          localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
        } catch (err) {
          // fail silently; storage may be blocked
        }
      }

      function restoreState() {
        try {
          const saved = localStorage.getItem(STORAGE_KEY);
          if (!saved) return;
          const parsed = JSON.parse(saved);
          if (parsed.values) {
            const { task, freq, minutes, hourly, role, pain } = parsed.values;
            els.fields.task.value = task || "";
            els.fields.freq.value = freq || "";
            els.fields.minutes.value = minutes || "";
            els.fields.hourly.value = hourly || "";
            els.fields.role.value = role || "";
            els.painInput.value = pain || 5;
            els.painDisplay.textContent = els.painInput.value;
          }
          if (parsed.readiness) {
            state.formReadiness = parsed.readiness;
          }
          if (Array.isArray(parsed.tasks)) {
            state.tasks = parsed.tasks;
          }
          state.editingId = parsed.editingId || null;
          if (parsed.formReadiness) {
            state.formReadiness = parsed.formReadiness;
          }
        } catch (err) {
          console.warn("Could not restore saved state", err);
        }
      }

      function resetForm() {
        els.fields.task.value = "";
        els.fields.freq.value = "";
        els.fields.minutes.value = "";
        els.fields.hourly.value = "";
        els.fields.role.value = "";
        setPainValue(5, true);
        state.formReadiness = {};
        state.editingId = null;
        renderTaskReadinessForm();
        setSaveMode();
      }

      function setSaveMode() {
        els.saveTaskBtn.textContent = state.editingId ? "Update task" : "Save task";
      }

      function loadTaskIntoForm(task) {
        els.fields.task.value = task.task || "";
        els.fields.freq.value = task.freq || "";
        els.fields.minutes.value = task.minutes || "";
        els.fields.hourly.value = task.hourly || "";
        els.fields.role.value = task.role || "";
        setPainValue(task.pain || 5, true);
        state.formReadiness = task.readiness || {};
        renderTaskReadinessForm();
        state.editingId = task.id;
        setSaveMode();
      }

      function renderTaskList() {
        els.taskList.innerHTML = "";
        if (!state.tasks.length) {
          els.taskEmpty.style.display = "block";
          return;
        }
        els.taskEmpty.style.display = "none";
        state.tasks.forEach((task) => {
          const metrics = calculateTaskMetrics(task);
          const row = document.createElement("div");
          row.style.display = "flex";
          row.style.alignItems = "center";
          row.style.justifyContent = "space-between";
          row.style.gap = "10px";
          row.style.border = `1px solid ${getComputedStyle(document.documentElement).getPropertyValue("--va-line") || "#d9e1ea"}`;
          row.style.borderRadius = "14px";
          row.style.padding = "12px 14px";
          row.style.background = "var(--va-panel)";
          row.style.boxShadow = "0 10px 28px rgba(19,64,97,0.12)";

          const left = document.createElement("div");
          left.innerHTML = `<strong style="font-size:1.05rem;">${task.task}</strong><div style="color:var(--va-muted);font-size:0.9rem;margin-top:2px;">${task.role || "Owner"}</div><div style="color:var(--va-accent);font-weight:700;margin-top:6px;">${metrics.weeklyHours.toFixed(1)} hrs/wk · ${formatCurrency(metrics.annualCost)}/yr · ${formatCurrency(metrics.savings)} est. savings</div>`;

          const actions = document.createElement("div");
          actions.style.display = "flex";
          actions.style.alignItems = "center";
          actions.style.gap = "8px";

          const editBtn = document.createElement("button");
          editBtn.textContent = "Edit";
          editBtn.className = "va-btn";
          editBtn.addEventListener("click", () => {
            loadTaskIntoForm(task);
          });

          const viewBtn = document.createElement("button");
          viewBtn.textContent = "View";
          viewBtn.className = "va-btn";
          viewBtn.addEventListener("click", () => {
            update();
            location.hash = "#part-3";
          });

          const removeBtn = document.createElement("button");
          removeBtn.textContent = "Remove";
          removeBtn.className = "va-btn";
          removeBtn.addEventListener("click", () => {
            state.tasks = state.tasks.filter((t) => t.id !== task.id);
            renderTaskList();
            update();
          });

          actions.appendChild(viewBtn);
          actions.appendChild(removeBtn);
          actions.appendChild(editBtn);
          row.appendChild(left);
          row.appendChild(actions);
          els.taskList.appendChild(row);
        });
      }

      function getPortfolioTasks() {
        if (state.tasks.length) return state.tasks;
        const fallback = getFormTask();
        return fallback.task || fallback.freq || fallback.minutes || fallback.hourly ? [fallback] : [];
      }

      function renderROI(tasks) {
        const totals = calculateTotals(tasks);

        els.weeklyHours.textContent = `${totals.weeklyHours.toFixed(1)} hrs / week`;
        els.annualHours.textContent = totals.annualHours.toFixed(1);
        els.annualCost.textContent = `${formatCurrency(totals.annualCost)} / year`;
        els.savingsFigure.textContent = formatCurrency(totals.savings);

        const maxCost = Math.max(totals.annualCost, totals.savings, 1);
        els.costBar.style.width = `${percentOf(maxCost, totals.annualCost)}%`;
        els.savingsBar.style.width = `${percentOf(maxCost, totals.savings)}%`;

        return totals;
      }

      function renderTaskTable(tasks, totals) {
        els.taskTableBody.innerHTML = "";
        const hasTasks = tasks.length > 0;
        els.taskTableEmpty.style.display = hasTasks ? "none" : "block";
        if (!hasTasks) {
          els.totalWeekly.textContent = "0";
          els.totalAnnual.textContent = "0";
          els.totalCost.textContent = "$0";
          els.totalSavings.textContent = "$0";
          return;
        }

        tasks.forEach((task) => {
          const metrics = calculateTaskMetrics(task);
          const row = document.createElement("div");
          row.className = "va-table-row";
          row.innerHTML = `
            <span><strong>${task.task || "Untitled task"}</strong><small>${task.freq || 0}x/wk · ${task.minutes || 0} min each</small></span>
            <span>${task.role || "Owner"}</span>
            <span style="font-weight:700;color:var(--va-accent);">${metrics.weeklyHours.toFixed(1)}</span>
            <span>${metrics.annualHours.toFixed(1)}</span>
            <span style="font-weight:700;color:var(--va-accent);">${formatCurrency(metrics.annualCost)}</span>
            <span>${formatCurrency(metrics.savings)}</span>
          `;
          els.taskTableBody.appendChild(row);
        });

        els.totalWeekly.textContent = totals.weeklyHours.toFixed(1);
        els.totalAnnual.textContent = totals.annualHours.toFixed(1);
        els.totalCost.textContent = formatCurrency(totals.annualCost);
        els.totalSavings.textContent = formatCurrency(totals.savings);
      }

      function renderMatrix(tasks) {
        const canvas = els.matrixCanvas;
        if (!canvas) return;
        const ctx = canvas.getContext("2d");
        const rect = canvas.getBoundingClientRect();
        canvas.width = rect.width;
        canvas.height = rect.height;
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        let tooltip = els.matrixPlot.querySelector(".va-tooltip");
        if (!tooltip) {
          tooltip = document.createElement("div");
          tooltip.className = "va-tooltip";
          tooltip.style.position = "absolute";
          tooltip.style.padding = "10px 12px";
          tooltip.style.borderRadius = "10px";
          tooltip.style.background = getComputedStyle(document.documentElement).getPropertyValue("--va-primary") || "#134061";
          tooltip.style.color = "#fff";
          tooltip.style.fontSize = "0.9rem";
          tooltip.style.boxShadow = "0 12px 30px rgba(19,64,97,0.25)";
          tooltip.style.pointerEvents = "none";
          tooltip.style.display = "none";
          tooltip.style.zIndex = "5";
          tooltip.style.minWidth = "240px";
          tooltip.style.maxWidth = "320px";
          els.matrixPlot.appendChild(tooltip);
        }

        if (!tasks.length) {
          tooltip.style.display = "none";
          return;
        }

        const w = canvas.width;
        const h = canvas.height;
        const padding = 24;

        // Quadrants
        ctx.fillStyle = "rgba(201,75,75,0.12)";
        ctx.fillRect(0, 0, w / 2, h / 2);
        ctx.fillStyle = "rgba(19,64,97,0.12)";
        ctx.fillRect(w / 2, 0, w / 2, h / 2);
        ctx.fillStyle = "rgba(15,31,51,0.08)";
        ctx.fillRect(0, h / 2, w / 2, h / 2);
        ctx.fillStyle = "rgba(244,136,71,0.16)";
        ctx.fillRect(w / 2, h / 2, w / 2, h / 2);

        ctx.fillStyle = "rgba(19,64,97,0.45)";
        ctx.font = "700 14px " + (getComputedStyle(document.documentElement).getPropertyValue("--va-font") || "Inter, sans-serif");
        ctx.fillText("Strategic Bet", w * 0.65, h * 0.25);
        ctx.fillText("Trap", w * 0.15, h * 0.25);
        ctx.fillText("Hobby", w * 0.15, h * 0.75);
        ctx.fillText("Quick Win", w * 0.65, h * 0.75);

        // Use a fixed floor so single low-value tasks don't always pin to the far right.
        const IMPACT_FLOOR = 20000;
        const maxImpact = Math.max(...tasks.map((t) => calculateTaskMetrics(t).annualCost), IMPACT_FLOOR);
        matrixDots = [];

        tasks.forEach((task) => {
          const metrics = calculateTaskMetrics(task);
          const impactRatio = Math.min(1, Math.max(0, metrics.annualCost / maxImpact));
          const { score } = getReadinessScore(task.readiness || {});
          const effortRatio = Math.min(1, Math.max(0, (1 - score) + (10 - task.pain) / 25));
          const { badgeClass, label, note } = getDecisionMeta(metrics.annualCost, score);

          const x = padding + impactRatio * (w - padding * 2);
          const y = padding + (1 - effortRatio) * (h - padding * 2);

          ctx.beginPath();
          ctx.arc(x, y, 8, 0, Math.PI * 2);
          ctx.fillStyle =
            badgeClass === "quick"
              ? "#f48847"
              : badgeClass === "bet"
              ? "#134061"
              : badgeClass === "hobby"
              ? "rgba(82,104,128,0.9)"
              : "#c94b4b";
          ctx.fill();
          ctx.strokeStyle = "#fff";
          ctx.lineWidth = 2;
          ctx.stroke();

          matrixDots.push({
            x,
            y,
            r: 10,
            task: task.task,
            label,
            note,
            metrics,
          });
        });

        const handleHover = (evt) => {
          const rect = canvas.getBoundingClientRect();
          const x = evt.clientX - rect.left;
          const y = evt.clientY - rect.top;
          let hit = null;
          for (const dot of matrixDots) {
            const dx = x - dot.x;
            const dy = y - dot.y;
            if (Math.sqrt(dx * dx + dy * dy) <= dot.r + 2) {
              hit = dot;
              break;
            }
          }
          if (hit) {
            tooltip.style.display = "block";
            tooltip.innerHTML = `<strong>${hit.task}</strong><div style="font-size:0.85rem;margin-top:4px;">${hit.label}</div><div style="font-size:0.85rem;color:rgba(255,255,255,0.85);">Annual: ${formatCurrency(hit.metrics.annualCost)} · Weekly: ${hit.metrics.weeklyHours.toFixed(1)} hrs · Savings 50%: ${formatCurrency(hit.metrics.savings)}</div><div style="font-size:0.8rem;color:rgba(255,255,255,0.7);margin-top:4px;">${hit.note}</div>`;

            // Flip tooltip to the left when hovering near the right edge to avoid clipping
            const offset = 12;
            const tooltipWidth = tooltip.offsetWidth || 260;
            const tooltipHeight = tooltip.offsetHeight || 120;
            let left = hit.x + offset;
            const maxLeft = canvas.width - tooltipWidth - offset;
            if (left > maxLeft) {
              left = hit.x - tooltipWidth - offset;
            }
            left = Math.max(8, Math.min(left, maxLeft));

            let top = hit.y - tooltipHeight / 2;
            top = Math.max(8, Math.min(top, canvas.height - tooltipHeight - 8));

            tooltip.style.left = `${left}px`;
            tooltip.style.top = `${top}px`;
          } else {
            tooltip.style.display = "none";
          }
        };

        if (!canvas._hoverBound) {
          canvas.addEventListener("mousemove", handleHover);
          canvas.addEventListener("mouseleave", () => {
            const tooltip = els.matrixPlot.querySelector(".va-tooltip");
            if (tooltip) tooltip.style.display = "none";
          });
          canvas._hoverBound = true;
        }
      }

      function renderClassificationTable(tasks) {
        els.classificationTable.innerHTML = "";
        const hasTasks = tasks.length > 0;
        els.classificationEmpty.style.display = hasTasks ? "none" : "block";
        if (!hasTasks) return;

        tasks.forEach((task) => {
          const metrics = calculateTaskMetrics(task);
          const { score } = getReadinessScore(task.readiness || {});
          const { label, impactLevel, effortLevel, badgeClass } = getDecisionMeta(metrics.annualCost, score);
          const row = document.createElement("div");
          row.className = "va-table-row";
          row.innerHTML = `
            <span><strong>${task.task || "Untitled task"}</strong><small>${task.freq || 0}x/wk · ${task.minutes || 0} min</small></span>
            <span>${task.role || "Owner"}</span>
            <span>${impactLevel}</span>
            <span>${effortLevel}</span>
            <span style="font-weight:700;color:var(--va-danger);">${formatCurrency(metrics.annualCost)}</span>
            <span style="font-weight:700;color:var(--va-success);">${formatCurrency(metrics.savings)}</span>
            <span><span class="priority-pill ${badgeClass}">${label}</span></span>
          `;
          els.classificationTable.appendChild(row);
        });
      }

      async function postWebhook(payload, pdfBase64) {
        const fullPayload = pdfBase64
          ? {
              ...payload,
              pdf: {
                filename: "Valid-Agenda-Automation-ROI-Report.pdf",
                mimeType: "application/pdf",
                base64: pdfBase64,
              },
            }
          : payload;

        const sendBeacon = () => {
          if (!navigator.sendBeacon) return false;
          try {
            // sendBeacon has a ~64kb limit; omit PDF to ensure delivery.
            const compact = { ...payload, pdf: undefined };
            const blob = new Blob([JSON.stringify(compact)], { type: "application/json" });
            return navigator.sendBeacon(WEBHOOK_URL, blob);
          } catch (err) {
            console.warn("sendBeacon failed", err);
            return false;
          }
        };

        try {
          const res = await fetch(WEBHOOK_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(fullPayload),
          });
          return res;
        } catch (err) {
          console.warn("Webhook fetch failed, falling back to no-cors", err);
          // Fallback for CORS-restricted environments; if this fails, try sendBeacon without PDF.
          try {
            await fetch(WEBHOOK_URL, {
              method: "POST",
              mode: "no-cors",
              headers: { "Content-Type": "text/plain;charset=UTF-8" },
              body: JSON.stringify(fullPayload),
            });
            return { ok: true, opaque: true };
          } catch (fallbackErr) {
            console.warn("no-cors fallback failed, trying sendBeacon", fallbackErr);
            const beaconSent = sendBeacon();
            if (beaconSent) return { ok: true, beacon: true };
            throw fallbackErr;
          }
        }
      }

      async function submitLeadMagnet(evt) {
        evt.preventDefault();
        if (!els.leadForm) return;

        const firstName = (els.leadFirstName?.value || "").trim();
        const lastName = (els.leadLastName?.value || "").trim();
        const leadRole = els.leadRole?.value || "";
        const email = els.leadEmail.value.trim();
        const consent = els.leadConsent.checked;

        if (!firstName || !lastName || !leadRole) {
          setLeadStatus("Add your name and role to continue.", "error");
          return;
        }
        if (!validateEmail(email)) {
          setLeadStatus("Enter a valid email to continue.", "error");
          return;
        }
        if (!consent) {
          setLeadStatus("Please confirm you agree to communications.", "error");
          return;
        }

        setLeadStatus("Sending to Valid Agenda...", "");
        if (els.leadSubmit) {
          els.leadSubmit.disabled = true;
          els.leadSubmit.textContent = "Working...";
        }

        const tasks = getPortfolioTasks();
        const totals = calculateTotals(tasks);

        const tasksWithMeta = tasks.map((task) => {
          const metrics = calculateTaskMetrics(task);
          const readiness = getReadinessScore(task.readiness || {});
          const decision = getDecisionMeta(metrics.annualCost, readiness.score);
          return {
            task: task.task,
            role: task.role,
            freq: task.freq,
            minutes: task.minutes,
            hourly: task.hourly,
            pain: task.pain,
            readiness: task.readiness,
            readinessScore: readiness.score,
            readinessEffort: readiness.effort,
            metrics,
            priority: decision.label,
            priorityClass: decision.badgeClass,
          };
        });

        const payload = {
          firstName,
          lastName,
          role: leadRole,
          email,
          consent,
          submittedAt: new Date().toISOString(),
          source: "Automation ROI Calculator",
          hasSavedTasks: !!state.tasks.length,
          totals,
          tasks: tasksWithMeta,
          location: window.location.href,
        };

        let downloadOk = true;
        let pdfBase64 = null;
        // Generate + download PDF while preparing webhook payload
        try {
          const pdfBlob = await buildReportPdf(tasksWithMeta, totals);
          pdfBase64 = await blobToBase64(pdfBlob);
          downloadBlob(pdfBlob, "Valid-Agenda-Automation-ROI-Report.pdf");
        } catch (err) {
          console.error("PDF build/download failed", err);
          setLeadStatus("Download failed. Please retry.", "error");
          downloadOk = false;
        }

        try {
          const res = await postWebhook(payload, pdfBase64);
          if (res && res.ok) {
            if (downloadOk) {
              setLeadStatus("Thanks! Your PDF is downloading and we’ll follow up shortly.", "success");
            }
          } else {
            setLeadStatus(downloadOk ? "PDF is downloading. Follow-up may not be recorded—please try again later." : "Follow-up may not be recorded—please try again later.", "error");
          }
        } catch (err) {
          console.error("Lead capture failed", err);
          setLeadStatus(downloadOk ? "PDF is downloading. We couldn't reach the server—please try again." : "We couldn't reach the server—please try again.", "error");
        } finally {
          if (els.leadSubmit) {
            els.leadSubmit.disabled = false;
            els.leadSubmit.textContent = "Download PDF";
          }
        }
      }

      function update() {
        if (!validateNumbers()) return;
        const tasks = getPortfolioTasks();
        const totals = renderROI(tasks);
        renderTaskTable(tasks, totals);
        renderMatrix(tasks);
        renderClassificationTable(tasks);
        saveState();
      }

      function attachEvents() {
        Object.values(els.fields).forEach((input) => {
          input.addEventListener("input", update);
        });
        els.painChips.forEach((chip) => {
          chip.addEventListener("click", () => {
            setPainValue(Number(chip.dataset.pain));
          });
        });

        els.saveTaskBtn.addEventListener("click", () => {
          if (!validateForSave()) return;
          const task = { ...getFormTask(), id: state.editingId || (crypto.randomUUID ? crypto.randomUUID() : String(Date.now() + Math.random())) };
          if (state.editingId) {
            state.tasks = state.tasks.map((t) => (t.id === state.editingId ? task : t));
          } else {
            state.tasks.push(task);
          }
          renderTaskList();
          resetForm();
          update();
        });

        window.addEventListener("resize", () => {
          renderMatrix(getPortfolioTasks());
        });

        if (els.leadForm) {
          els.leadForm.addEventListener("submit", submitLeadMagnet);
        }
      }

      // Initialize
      restoreState();
      setPainValue(Number(els.painInput.value) || 5, true);
      renderTaskReadinessForm();
      renderTaskList();
      setSaveMode();
      attachEvents();
      update();
    })();
  </script>
</body>
</html>
